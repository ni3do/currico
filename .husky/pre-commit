#!/bin/sh

# Auto-update package-lock.json if package.json was modified
if git diff --cached --name-only | grep -q "^package\.json$"; then
  echo "package.json changed, updating package-lock.json..."
  npm install --package-lock-only
  git add package-lock.json
fi

# Regenerate Prisma client if schema.prisma was modified
if git diff --cached --name-only | grep -q "^prisma/schema\.prisma$"; then
  echo "schema.prisma changed, regenerating Prisma client..."
  npx prisma generate
fi

# Run lint-staged
npx lint-staged
